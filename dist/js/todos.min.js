const todoFormElement=document.querySelector("#todo-management form"),todosListElement=document.getElementById("todos-list");let editedTodoElement;async function loadTodos(){let t;try{t=await fetch("http://localhost:3005/todos")}catch(t){return void alert("Something went wrong!")}if(t.ok)for(const e of(await t.json()).todos)createTodoListItem(e.text,e.id);else alert("Something went wrong!")}function createTodoListItem(t,e){var o=document.createElement("li");o.dataset.todoid=e,(e=document.createElement("p")).textContent=t;(t=document.createElement("button")).textContent="Edit",t.addEventListener("click",startTodoEditing);var n=document.createElement("button"),d=(n.textContent="Delete",n.addEventListener("click",deleteTodo),document.createElement("div"));d.appendChild(t),d.appendChild(n),o.appendChild(e),o.appendChild(d),todosListElement.appendChild(o)}async function createTodo(t){let e;try{e=await fetch("http://localhost:3005/todos",{method:"POST",body:JSON.stringify({text:t}),headers:{"Content-Type":"application/json"}})}catch(t){return void alert("Something went wrong!")}e.ok?createTodoListItem(t,(await e.json()).createdTodo.id):alert("Something went wrong!")}async function updateTodo(t){var e=editedTodoElement.dataset.todoid;let o;try{o=await fetch("http://localhost:3005/todos/"+e,{method:"PATCH",body:JSON.stringify({newText:t}),headers:{"Content-Type":"application/json"}})}catch(t){return void alert("Something went wrong!")}o.ok?(editedTodoElement.firstElementChild.textContent=t,todoFormElement.querySelector("input").value="",editedTodoElement=null):alert("Something went wrong!")}async function deleteTodo(t){var e=(t=t.target.parentElement.parentElement).dataset.todoid;let o;try{o=await fetch("http://localhost:3005/todos/"+e,{method:"DELETE"})}catch(t){return void alert("Something went wrong!")}o.ok?t.remove():alert("Something went wrong!")}function saveTodo(t){t.preventDefault(),t=new FormData(t.target).get("text"),(editedTodoElement?updateTodo:createTodo)(t)}function startTodoEditing(t){t=t.target,t=(editedTodoElement=t.parentElement.parentElement).firstElementChild.textContent,todoFormElement.querySelector("input").value=t}todoFormElement.addEventListener("submit",saveTodo),loadTodos();